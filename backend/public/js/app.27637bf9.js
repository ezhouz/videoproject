(function(e){function t(t){for(var a,s,i=t[0],l=t[1],u=t[2],d=0,p=[];d<i.length;d++)s=i[d],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&p.push(o[s][0]),o[s]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);c&&c(t);while(p.length)p.shift()();return n.push.apply(n,u||[]),r()}function r(){for(var e,t=0;t<n.length;t++){for(var r=n[t],a=!0,i=1;i<r.length;i++){var l=r[i];0!==o[l]&&(a=!1)}a&&(n.splice(t--,1),e=s(s.s=r[0]))}return e}var a={},o={app:0},n=[];function s(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=a,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(r,a,function(t){return e[t]}.bind(null,a));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var c=l;n.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"034f":function(e,t,r){"use strict";r("85ec")},1:function(e,t){},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var a=r("2b0e"),o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("div",{attrs:{id:"nav"}},[r("router-link",{attrs:{to:"/"}},[e._v("Home")]),r("router-link",{attrs:{to:"/uploadvideo"}},[e._v("Upload")]),e._v(" | "),r("router-link",{attrs:{to:"/vote"}},[e._v("Vote")]),r("router-link",{attrs:{to:"/register"}},[e._v("Register")]),r("router-link",{attrs:{to:"/login"}},[e._v("Login")]),r("router-link",{attrs:{to:"/logout"}},[e._v("Logout")])],1),r("router-view")],1)},n=[],s=(r("034f"),r("2877")),i={},l=Object(s["a"])(i,o,n,!1,null,null,null),u=l.exports,c=r("8c4f"),d=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},p=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",[r("h1",[e._v("Home Page updated")])])}],m={},v=Object(s["a"])(m,d,p,!1,null,null,null),g=v.exports,f=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"notices"},[e.loadError?r("div",{staticClass:"errornotice"},[r("h3",[e._v(e._s(e.loadErrorMessge))])]):e._e()]),e._l(e.videos,(function(t){return r("div",{key:t.id,staticClass:"submission"},[r("div",{staticClass:"player"},[r("video-player",{attrs:{options:{autoplay:!1,controls:!0,poster:t.thumbnail,sources:[{src:t.src,type:t.type}]}}})],1),r("div",{staticClass:"video-form"},[r("b-input-group",[r("b-input-group-prepend",[r("b-btn",{attrs:{variant:"outline-info"},on:{click:function(r){return e.changeVoteCount("minus",t.newVotes,t.id)}}},[e._v("-")])],1),r("b-form-input",{attrs:{type:"number",min:"0"},on:{change:function(r){return e.changeVoteCount(t.newVotes,t.id)}},model:{value:t.newVotes,callback:function(r){e.$set(t,"newVotes",r)},expression:"video.newVotes"}}),r("b-input-group-append",[r("b-btn",{attrs:{variant:"outline-secondary"},on:{click:function(r){return e.changeVoteCount("plus",t.newVotes,t.id)}}},[e._v("+")])],1)],1)],1)])}))],2)},h=[],b=r("1da1"),w=(r("96cf"),r("159b"),r("bc3a")),_=r.n(w),y=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("video",{ref:"videoPlayer",staticClass:"video-js"})])},x=[],k=r("f0e2"),E={name:"VideoPlayer",props:{options:{type:Object,default:function(){return{}}}},data:function(){return{player:null}},mounted:function(){this.player=Object(k["a"])(this.$refs.videoPlayer,this.options,(function(){}))},beforeDestroy:function(){this.player&&this.player.dispose()}},O=E,V=Object(s["a"])(O,y,x,!1,null,null,null),U=V.exports,I=(r("fda2"),{name:"Votes",components:{VideoPlayer:U},data:function(){return{backendUrl:"http://localhost:3001",loadError:!1,loadErrorMessge:"",videos:[],voteInfo:[],voteInfoVideoIds:[],videoOptions:{},votingData:{}}},created:function(){var e=this;return Object(b["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,_.a.get("".concat(e.backendUrl,"/getall/current-vote-count"));case 2:if(r=t.sent,200!==r.status)e.loadError=!0,e.loadErrorMessge="Error loading vote information";else try{e.voteInfo=r.data,r.data.forEach((function(t){return e.voteInfoVideoIds.push(t.muxVideoId)}))}catch(o){console.log(o)}return t.next=6,_.a.get("".concat(e.backendUrl,"/getall/allvideos"));case 6:a=t.sent;try{a.data.forEach((function(t){var r=t.muxVideoId;e.videos.push({src:"https://stream.mux.com/".concat(r,".m3u8"),thumbnail:"https://image.mux.com/".concat(r,"/thumbnail.jpg"),type:"application/x-mpegURL",voteTally:t.voteTally,newVotes:0,id:r})}))}catch(o){e.loadError=!0,e.loadErrorMessge="Error loading videos",console.log(o)}case 8:case"end":return t.stop()}}),t)})))()},methods:{changeVoteCount:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;null!==t&&("minus"===t?r--:"plus"===t&&r++),this.videos.forEach((function(t){console.log(t.id),t.id===a&&(console.log(r),t.newVotes=r),console.log(e.videos)}))},submitStripePayment:function(){_.a.post("".concat(this.backendUrl,"/post/create-checkout-session"))}}}),j=I,D=Object(s["a"])(j,f,h,!1,null,"2d918efd",null),M=D.exports,P=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",[r("article",[r("label",{attrs:{for:"date"}},[e._v("Enter your DOB")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.uploaderDOBEnglish,expression:"uploaderDOBEnglish"}],attrs:{type:"date",name:"",id:"date"},domProps:{value:e.uploaderDOBEnglish},on:{input:function(t){t.target.composing||(e.uploaderDOBEnglish=t.target.value)}}}),r("button",{on:{click:function(t){e.convertDate(JSON.stringify(e.uploaderDOBEnglish))}}},[e._v(" Submit ")])]),e.uploaderDOBHebrew?r("article",[e._v(" "+e._s(e.uploaderDOBHebrewMessage)+" "),r("h2",[e._v("Register")]),e.showError?r("div",[e._v(" "+e._s(e.errorMessage)+" ")]):e._e(),r("form",{on:{submit:function(t){return t.preventDefault(),e.registerUser(e.user)}}},[r("input",{attrs:{type:"hidden",name:"hebDate"}}),r("label",{attrs:{for:"firstname"}},[e._v("First Name")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.user.firstname,expression:"user.firstname"}],attrs:{type:"text",name:"firstname",id:"firstname"},domProps:{value:e.user.firstname},on:{input:function(t){t.target.composing||e.$set(e.user,"firstname",t.target.value)}}}),r("label",{attrs:{for:"lastname"}},[e._v("First Name")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.user.lastname,expression:"user.lastname"}],attrs:{type:"text",name:"lastname",id:"lastname"},domProps:{value:e.user.lastname},on:{input:function(t){t.target.composing||e.$set(e.user,"lastname",t.target.value)}}}),r("label",{attrs:{for:"email"}},[e._v("Email")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.user.email,expression:"user.email"}],attrs:{type:"email",name:"email",id:"email"},domProps:{value:e.user.email},on:{input:function(t){t.target.composing||e.$set(e.user,"email",t.target.value)}}}),r("label",{attrs:{for:"password"}},[e._v("Password")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.user.password,expression:"user.password"}],attrs:{type:"password",name:"password",id:"password"},domProps:{value:e.user.password},on:{input:function(t){t.target.composing||e.$set(e.user,"password",t.target.value)}}}),r("label",{attrs:{for:"passwordrepeat"}},[e._v("Repeat Password")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.user.passwordrepeat,expression:"user.passwordrepeat"}],attrs:{type:"password",name:"passwordrepeat",id:"passwordrepeat"},domProps:{value:e.user.passwordrepeat},on:{input:function(t){t.target.composing||e.$set(e.user,"passwordrepeat",t.target.value)}}}),r("button",[e._v("Register")])])]):e._e()])},B=[],R=(r("99af"),{name:"Register",data:function(){return{showError:!1,backendUrl:"http://localhost:3001",errorMessage:"",uploaderDOBEnglish:"",uploaderDOBHebrew:"",uploaderDOBHebrewMessage:"",user:{firstname:"",lastname:"",email:"",password:"",passwordRepeat:""}}},methods:{convertDate:function(e){var t=this;return Object(b["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,_.a.post("".concat(t.backendUrl,"/post/convertdate"),{date:e});case 3:a=r.sent,a&&(t.uploaderDOBHebrewMessage="Your Hebrew Date of birth is ".concat(a.data.date," ").concat(a.data.month_name," ").concat(a.data.year),t.uploaderDOBHebrew="".concat(a.data.date,"-").concat(a.data.month_name,"-").concat(a.data.year)),r.next=10;break;case 7:r.prev=7,r.t0=r["catch"](0),console.log(r.t0);case 10:case"end":return r.stop()}}),r,null,[[0,7]])})))()},registerUser:function(e){var t=this;return Object(b["a"])(regeneratorRuntime.mark((function r(){var a,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=e,a.password===a.passwordrepeat){r.next=5;break}return t.showError=!0,t.errorMessage="Passwords don't match",r.abrupt("return");case 5:return a.uploaderDOBEnglish=t.uploaderDOBEnglish,a.uploaderDOBHebrew=t.uploaderDOBHebrew,r.prev=7,r.next=10,_.a.post("".concat(t.backendUrl,"/auth/register"),{user:a});case 10:o=r.sent,201===o.data.status?(t.showError=!0,t.errorMessage=o.data.message):200===o.data.status?t.$router.push("/login"):(t.showError=!0,t.errorMessage=o.data.message),r.next=18;break;case 14:r.prev=14,r.t0=r["catch"](7),t.showError=!0,t.errorMessage=r.t0;case 18:case"end":return r.stop()}}),r,null,[[7,14]])})))()}}}),$=R,N=Object(s["a"])($,P,B,!1,null,"01e9a2d8",null),F=N.exports,C=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",[r("article",[r("h2",[e._v("Log In")]),r("form",{on:{submit:function(t){return t.preventDefault(),e.loginUser(e.email,e.password)}}},[r("label",{attrs:{for:"email"}},[e._v("Email")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],attrs:{type:"email",name:"email",id:"email"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}}),r("label",{attrs:{for:"password"}},[e._v("Password")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"password",name:"password",id:"password"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),r("button",[e._v("Log In")])])])])},S=[],H={name:"Login",data:function(){return{backendUrl:"http://localhost:3001",showError:!1,errorMessage:"",email:"mediablokedeals@gmail.com",password:"password"}},methods:{loginUser:function(e,t){var r=this;return Object(b["a"])(regeneratorRuntime.mark((function a(){var o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,_.a.post("/api/auth/login",{email:e,password:t});case 3:o=a.sent,o?(localStorage.setItem("chabadtoken",o.data.token),r.$router.push({name:"UploadVideo"})):(r.showError=!0,r.errorMessage=o),a.next=10;break;case 7:a.prev=7,a.t0=a["catch"](0),console.log(a.t0);case 10:case"end":return a.stop()}}),a,null,[[0,7]])})))()}}},L=H,T=Object(s["a"])(L,C,S,!1,null,"2d56de12",null),A=T.exports,z=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",[r("article",{staticClass:"messages"},[e.showError?r("div",{staticClass:"errorMessage"},[e._v(" "+e._s(e.uploadErrorMessage)+" ")]):e._e(),e.loggedInUser?r("div",{staticClass:"user-info"},[e._v(" "+e._s(e.loggedInUser.firstname)+" "+e._s(e.loggedInUser.lastname)+" "+e._s(e.loggedInUser.email)+" "+e._s(e.loggedInUser.hebrewDOB)+" ")]):e._e()]),r("article",[r("input",{attrs:{id:"uploadedVideoFile",type:"file",accept:"video/*"},on:{change:e.getFileName}}),r("button",{on:{click:function(t){return e.uploadVideo(e.uploadedVideoFile)}}},[e._v("Upload Video File")])]),r("article",[e.progress>0&&e.progress<100?r("div",{staticClass:"progress"},[r("div",{staticClass:"progress-bar progress-bar-striped bg-info",style:{width:e.progress+"%"},attrs:{role:"progressbar","aria-valuenow":"50","aria-valuemin":"0","aria-valuemax":"100"}})]):e._e()])])},J=[],q=(r("b0c0"),r("35f2")),Y={name:"UploadVideo",data:function(){return{existingToken:"",backendUrl:"http://localhost:3001",uploadedVideoFile:"",uploadedVideoFileName:"",showUploadError:!1,uploadErrorMessage:"",showUploadSuccess:!1,uploadSuccessMessage:"",loggedInUser:null,showError:!1,progress:0,newVideoOptions:{}}},created:function(){var e=this;return Object(b["a"])(regeneratorRuntime.mark((function t(){var r,a,o,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=localStorage.getItem("chabadtoken"),r){t.next=5;break}e.$router.push({name:"Login"}),t.next=31;break;case 5:return a={headers:{Authorization:"Bearer ".concat(r)}},e.existingToken=a,t.prev=7,t.next=10,_.a.post("".concat(e.backendUrl,"/post/validatetoken"),{},a);case 10:if(o=t.sent,200!==o.data.status){t.next=24;break}return t.prev=12,t.next=15,_.a.get("".concat(e.backendUrl,"/get/getuser"),a);case 15:n=t.sent,e.loggedInUser=n.data,t.next=22;break;case 19:t.prev=19,t.t0=t["catch"](12),console.error(t.t0);case 22:t.next=26;break;case 24:e.showError=!0,e.uploadErrorMessage="Invalid Token";case 26:t.next=31;break;case 28:t.prev=28,t.t1=t["catch"](7),console.log(t.t1);case 31:case"end":return t.stop()}}),t,null,[[7,28],[12,19]])})))()},methods:{getFileName:function(){this.uploadedVideoFile=document.getElementById("uploadedVideoFile").files[0],this.uploadedVideoFileName=document.getElementById("uploadedVideoFile").files[0].name},uploadVideo:function(){var e=this;return Object(b["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,_()({method:"post",url:"".concat(e.backendUrl,"/post/processvid"),data:{}});case 2:if(r=t.sent,console.log(r),200===r.status){e.newVideoOptions.uploaderId=e.loggedInUser.id,e.newVideoOptions.videoUploadId=r.data.id,e.newVideoOptions.uploaderEmail=e.loggedInUser.email,e.newVideoOptions.uploadedVideoFileName=e.uploadedVideoFileName;try{a=q["createUpload"]({endpoint:r.data.url,file:document.getElementById("uploadedVideoFile").files[0],chunkSize:5120}),a.on("error",(function(t){e.showUploadError=!0,e.uploadErrorMessage=t.detail,console.error("💥 🙀",t.detail)})),a.on("progress",(function(t){e.progress=t.detail})),a.on("success",Object(b["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,_.a.post("".concat(e.backendUrl,"/post/create-new-product"),e.newVideoOptions,e.existingToken);case 2:r=t.sent,console.log(r);case 4:case"end":return t.stop()}}),t)}))))}catch(o){console.log(o)}}else console.log("error");case 5:case"end":return t.stop()}}),t)})))()}}},G=Y,K=Object(s["a"])(G,z,J,!1,null,"5b126eae",null),Q=K.exports,W=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div")},X=[],Z={name:"Logout",created:function(){localStorage.removeItem("chabadtoken"),this.$router.push("/")}},ee=Z,te=Object(s["a"])(ee,W,X,!1,null,null,null),re=te.exports;a["default"].use(c["a"]);var ae=[{path:"/",name:"Home",component:g},{path:"/uploadvideo",name:"UploadVideo",component:Q,meta:{requiresAuth:!0}},{path:"/vote",name:"Vote",component:M},{path:"/register",name:"Register",component:F},{path:"/login",name:"Login",component:A},{path:"/logout",name:"logout",component:re}],oe=new c["a"]({mode:"history",base:"/",routes:ae});oe.beforeEach((function(e,t,r){if(e.matched.some((function(e){return e.meta.requiresAuth}))){var a=localStorage.getItem("chabadtoken"),o={headers:{Authorization:"Bearer ".concat(a)}};_.a.post("http://".concat("http://localhost:3001","/post/validatetoken"),{},o).then((function(e){200!==e.data.status?r({name:"Login"}):r()}))}else r()}));var ne=oe,se=r("5f5b");r("f9e3"),r("2dd8");a["default"].use(c["a"]),a["default"].use(se["a"]),a["default"].config.productionTip=!1,new a["default"]({router:ne,render:function(e){return e(u)}}).$mount("#app")},"85ec":function(e,t,r){}});
//# sourceMappingURL=app.27637bf9.js.map